{% extends 'hotel_manager/layout.html' %}

{% block updaterooms %}
<li class="link active">
    <a href="/manager/update-rooms">
        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
        <span class="hidden-xs hidden-sm">Update Rooms</span>
    </a>
</li>
{% endblock %}

{%block content%}
	
<div id="content">
    <header class="clearfix">
        <h2 class="page-title pull-left">Update Rooms Status</h2>
        <a href="/manager/add-rooms" class="pull-right btn-xs btn btn-primary">
        	Add Room
        	<span class="glyphicon glyphicon-plus"></span>
        </a>
    </header>
    <div class="content-inner">
        <table class="table table-striped table-bordered table-hover table-condensed ">
            <thead>
                <tr class="success">
                    <th>#</th>
                    <th>Room Number</th>
                    <th>Beds</th>
                    <th>Price</th>
                    <th>Status</th>
                    <th>Available on</th>
                    <th>Actions</th>
                </tr>
            </thead>

            <tbody>
                {% for room in rooms %}
                <tr>
                    <td>{{room.id}}</td>
                    <td>{{room.number }}</td>
                    <td>{{room.beds}}</td>
                    <td>{{room.price}}</td>
                    <td>
                    {% if room.reserved %}
                    <button class="btn btn-md btn-secondary" type="button" data-toggle="modal" data-target="#{{room.id}}list" >
                    	Reserved
                    	<span class="glyphicon glyphicon-list"></span>
                    </button>	
                    <div id="{{room.id}}list" class="modal fade" role="dialog">
                      <div class="modal-dialog">

                        <!-- Modal content-->
                        <div class="modal-content">
                          <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                          </div>
                          <div class="modal-body">
                                <table class="table table-striped table-bordered table-hover table-condensed">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>FullName</th>
                                            <th>Email</th>
                                            <th>phone</th>
                                            <th>Time</th>
                                            <th>Room No</th>
                                            <th>Days</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                     {% for booked in room.reservedroom %}
                                        <tr>
                                            <td>
                                                {{booked.id}}
                                            </td>
                                            <td>{{booked.fullname}}</td>
                                            <td><a href="mailto:{{booked.email}}">{{booked.email}}</a></td>
                                            <td>{{booked.phone}}</td>
                                            <td>{{booked.arrival}} </td>
                                            <td><span class="badge badge-primary">{{booked.room.number}}</span></td>
                                            <td>
                                            	{{booked.days}} days
                                            </td>
                                        </tr>
                                     {%endfor%}
                                    </tbody>
                                </table>
                          </div>
                          <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                          </div>
                        </div>

                      </div>
                     </div>
                    {%else%}
                    	Not Reserved
                    {%endif%}
                	</td>
                    <td>
                        {{room.available_at.strftime('%a %b %Y')}}
                    </td>
                    <td>
                        <a href="{{url_for('delete', id=room.id, db_urls='Room',name=room.number)}}" class="btn btn-xs btn-danger ">
                            <span class="glyphicon glyphicon-remove"></span>
                            &nbsp;<label class="hidden-xs"> Delete</label>
                        </a>
                        <button class="btn btn-dark" type="button" data-toggle="modal" data-target="#{{room.id}}edit">Edit
                            <span class="glyphicon glyphicon-edit"></span>
                        </button>
                         <button class="btn btn-xs btn-info" type="button" data-toggle="modal" data-target="#{{room.id}}addimage">
                        	 <label class="hidden-xs"> Add Image</label>
                        	 <span class="glyphicon glyphicon-plus"></span>
                        </button>
                       
                    </td>
                </tr>
                 <div id="{{room.id}}edit" class="modal fade" role="dialog">
                      <div class="modal-dialog">

                        <!-- Modal content-->
                        <div class="modal-content">
                          <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                          </div>
                          <div class="modal-body">
                            <h5>Room Number {{room.number}}</h5>
                            <form method="post">
                                <input type="hidden" name="tag" value="{{room.number}}" >
                                <div class="form-group">
                                    <input type="radio" value="True" name="reserved" >True
                                    <input type="radio" value="False" name="reserved" >False
                                </div>
                                <div class="form-group">
                                    <label>available on</label>
                                    <input type="date" name="av_at" class="form-control" required="" >
                                </div>
                                <div class="form-group">
                                    <input type="submit" name="" value="Save Update" class="form-control btn btn-info">
                                </div>
                            </form>
                          </div>
                          <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                          </div>
                        </div>

                      </div>
                     </div>
                     <div id="{{room.id}}addimage" class="modal fade" role="dialog">
					  <div class="modal-dialog">
					    <!-- Modal content-->
					    <div class="modal-content">
					      <div class="modal-header">
					        <button type="button" class="close" data-dismiss="modal">&times;</button>
					      </div>
					      <div class="modal-body">
					      	{{g.user.hotel.hotel_name}}
					      	{{room.number}}
					           <form method="post" action="{{url_for('addroomimage')}}" enctype="multipart/form-data">
					           		<div class="form-group">
					           		<input type="hidden" value="{{g.user.hotel.hotel_name}}" name="hotel_name" >
					           		<input type="hidden" value="{{room.number}}" name="room_num">
					           		</div>
					           		<div class="form-group">
					           			<input type="file" name="file" class="form-control" placeholder="select jpg Image" >
					           		</div>
					           		<div class="form-group">
					           			<input type="submit" class="form-control btn btn-info" name=""  value=" Upload Image">
					           		</div>
					           </form>
					      </div>
					      <div class="modal-footer">
					        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					      </div>
					    </div>

					  </div>
					 </div>
                {% endfor%}
            </tbody>
        </table>
    </div>
</div>
{% endblock%}